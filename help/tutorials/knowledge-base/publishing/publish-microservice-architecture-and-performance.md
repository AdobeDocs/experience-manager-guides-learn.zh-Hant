---
title: 雲發佈微服務體系結構與效能
description: 瞭解新的微服務如何在AEMaaCS上實現可擴展發佈。
source-git-commit: 2e45f132ced5ac29118a7301f104bedc03c93253
workflow-type: tm+mt
source-wordcount: '730'
ht-degree: 0%

---


# 雲發佈微服務體系結構及效能分析

本文就新型雲發佈微服務的體系結構和效能資料進行了深入的探討。

>[!NOTE]
>
> 目前，指南中基於微服務的發AEM布僅支援使用本機PDF發佈或通過DITA-OT的PDF輸出。 指AEM南將添加基於微服務的發佈支援，以在未來版本中提供更多輸出類型。

## 雲上現有發佈工作流的問題

DITA發佈是一個資源密集型進程，主要取決於可用系統記憶體和CPU。 如果發佈者正在發佈包含許多主題的大型地圖，或觸發了多個並行發佈請求，則對這些資源的需求會進一步增加。

如果您沒有使用新服務，則所有發佈都發生在同一Kubernetes(k8)包上，該包也運行雲服AEM務器。 典型的k8 Pod對其可使用的記憶體和CPU數量有限制。 如AEM果指南用戶正在發佈大型或並行工作負載，則此限制可能會快速突破。 K8將重新啟動那些試圖使用比配置的限制更多資源的節點，這些限制可能對雲實例本AEM身產生嚴重影響。

此資源約束是我們推出專用服務的主要動機，該服務允許我們在雲上運行多個併發和大型發佈工作負載。

## 新體系結構簡介

該服務正在使用Adobe的尖端雲解決方案，如App Builder、IO Eventing和IMS，來建立無伺服器產品。 這些服務本身基於Kubernetes和Docker等被廣泛接受的行業標準。

對新發佈微服務的每個請求在一次只運行一個發佈請求的隔離的Docker容器中執行。 在收到新發佈請求時，會自動建立多個新容器。 此單個容器按請求配置，使微服務能夠為客戶提供最佳效能，而不會帶來任何安全風險。 一旦發佈結束，這些容器就會被丟棄，從而釋放所有未使用的資源。

所有這些通信都由Adobe IMS使用基於JWT的身份驗證和授權進行保護，並通過HTTPS執行。

<img src="assets/architecture.png" alt="項目頁籤" width="600">

>[!NOTE]
>
> 發佈進程在伺服器本身上執行請求的某些內容相關部AEM分，如依賴項清單生成。 但是，發佈過程中最詳盡的部分（如運行DITA-OT或本機引擎）已卸載到新服務。


## 效能分析

本部分顯示微服務的效能編號。 它將微服務的效能與AEMGuides on-prem產品進行了比較，因為舊的雲體系結構在併發發佈或發佈非常大的地圖方面存在問題。

如果要在預先發佈大型映射，則可能必須調整Java堆參數，否則可能會遇到記憶體不足錯誤。 在雲上，已對微服務進行配置，並且出廠時具備最佳的Java堆和其他配置。

### 在雲上運行一個發佈與在前

* 雲

   如果您使用新服務在雲上執行一次發佈，則與單次預先發佈相比，發佈可能需要更多時間。 這種短暫的提升時間是由於新雲架構的分佈性。

   <img src="assets/cloud_single_publish.png" alt="項目頁籤" width="600">

* 按預先

   單次發佈的結果在舊雲體系結構上或在預先上更好，因為完整發佈發生在運行的同一個pod/AEMmachine上。

   <img src="assets/onprem_single_publish.png" alt="項目頁籤" width="600">

### 在雲上運行多個發佈與在前

* 雲

   新的發佈微服務在此場景中脫穎而出。 正如您從下面的影像中看到的，隨著多個併發發佈作業的增加，雲能夠發佈它們，而發佈時間沒有顯著增加。

   <img src="assets/cloud_bulk_publish.png" alt="項目頁籤" width="600">

* 按預先

   在預備伺服器上運行併發發佈會導致效能嚴重下降。 如果出版商同時發佈更多地圖，這種效能下降將更為嚴重。

   <img src="assets/onprem_bulk_publish.png" alt="項目頁籤" width="600">

## 其他優勢

每個發佈請求的一部分必須在實AEM例上運行，以獲取要發送到microservice的正確發佈內容。 新的雲架構使AEM用作業代替AEM工作流，舊架構就是如此。 此更改使「指AEM南」管理員能夠單獨配置雲發佈隊列設定，而不影響其AEM他作業或工作流配置。

有關如何配置新發佈微服務的詳細資訊，請參閱： [配置Microservice](configure-microservices.md)