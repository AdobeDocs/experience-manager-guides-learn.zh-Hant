---
title: 雲發佈微服務架構與效能
description: 了解新的Microservice如何在AEMaCS上啟用可擴充的發佈。
source-git-commit: 2e45f132ced5ac29118a7301f104bedc03c93253
workflow-type: tm+mt
source-wordcount: '730'
ht-degree: 0%

---


# 雲發佈微服務架構與效能分析

本文分享新雲端發佈微服務架構與效能編號的相關分析。

>[!NOTE]
>
> 目前，AEM參考線中以微服務為基礎的發佈僅支援使用原生PDF發佈或透過DITA-OT進行PDF輸出。 AEM指南將新增微服務發佈支援，以在未來版本中提供更多輸出類型。

## 雲端上現有發佈工作流程的問題

DITA發佈是耗用大量資源的程式，主要取決於可用的系統記憶體和CPU。 如果發佈商發佈包含許多主題的大型地圖，或觸發多個平行發佈請求，則對這些資源的需求會進一步增加。

如果您未使用新服務，則所有發佈會發生在同時執行AEM雲端伺服器的相同Kubernetes(k8)pod上。 典型的k8 Pod對其可使用的記憶體和CPU數量有限制。 如果AEM指南使用者發佈大型或平行的工作負載，此限制可能會快速突破。 K8會重新啟動Pod，這些Pod會嘗試使用比已設定的限制更多的資源，而這可能會對AEM雲實例本身造成嚴重影響。

這種資源限制是我們提供專用服務的主要動機，該服務可讓我們在雲上同時運行多個大型發佈工作負載。

## 新架構簡介

該服務使用Adobe的尖端雲端解決方案（如App Builder、IO Eventing、IMS）來建立無伺服器產品。 這些服務本身以Kubernetes和Docker等廣為接受的行業標準為基礎。

每個對新發佈微服務的要求會在獨立的Docker容器中執行，該容器一次只執行一個發佈要求。 系統會自動建立多個新容器，以備收到新的發佈請求時使用。 此單一容器的每個請求配置允許微服務為客戶提供最佳效能，而不會帶來任何安全風險。 發佈一旦結束，這些容器就會遭到捨棄，因此可釋放任何未使用的資源。

所有這些通訊皆由Adobe IMS使用JWT型驗證和授權來保護，並透過HTTPS執行。

<img src="assets/architecture.png" alt="專案索引標籤" width="600">

>[!NOTE]
>
> 發佈程式會在AEM伺服器本身上執行請求的某些內容相依部分，例如產生相依性清單。 不過，發佈程式中最詳盡的部分（例如執行DITA-OT或原生引擎）已卸載至新服務。


## 效能分析

本節將展示Microservice的效能編號。 它會比較Microservice與AEM內部指南的效能，因為舊的雲端架構在同時發佈或發佈非常大型地圖時出現問題。

如果您是在預先發佈大型地圖，則可能必須調整Java堆參數，否則可能會遇到記憶體不足的錯誤。 在雲端上，已對微服務進行配置，並且具有最佳的Java堆和其他現成的配置。

### 在雲端與預備上執行一次發佈

* 雲

   如果您使用新服務在雲端上執行單一發佈，則與單一預先發佈相比，發佈可能需要更多時間。 這種微小的提升時間是由於新雲架構的分散性。

   <img src="assets/cloud_single_publish.png" alt="專案索引標籤" width="600">

* 內部部署

   單一發佈的結果在舊雲端架構上或內部部署上較好，因為完整發佈發生在執行AEM的相同pod/電腦上。

   <img src="assets/onprem_single_publish.png" alt="專案索引標籤" width="600">

### 在雲端與內部執行多個發佈

* 雲

   新的發佈微服務在此情境中顯得淋灕盡致。 如下圖所示，隨著多個同時發佈工作的增加，雲端可以發佈這些工作，而發佈時間不會大幅增加。

   <img src="assets/cloud_bulk_publish.png" alt="專案索引標籤" width="600">

* 內部部署

   在內部伺服器上執行同時發佈會導致效能嚴重下降。 如果發佈商同時發佈更多地圖，這種效能下降更為嚴重。

   <img src="assets/onprem_bulk_publish.png" alt="專案索引標籤" width="600">

## 其他優點

每個發佈請求的某些部分必須在AEM例項上執行，以擷取要傳送至Microservice的正確發佈內容。 新的雲端架構使用AEM工作來取代AEM工作流程，舊架構就是如此。 這項變更可讓AEM指南管理員個別設定雲端發佈佇列設定，而不會影響其他AEM工作或工作流程設定。

如需如何設定新發佈微服務的詳細資訊，請參閱： [配置微服務](configure-microservices.md)